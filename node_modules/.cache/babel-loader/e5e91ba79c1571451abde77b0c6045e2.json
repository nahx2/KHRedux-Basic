{"ast":null,"code":"var _jsxFileName = \"C:\\\\git_java20220415\\\\Redux-Basic\\\\src\\\\components\\\\talk\\\\TomatoTalk.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { getDatabase, ref, onValue, set } from \"firebase/database\";\nimport { initializeApp } from \"firebase/app\";\nimport { Button, Form, InputGroup } from \"react-bootstrap\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { MessageLi } from \"../style/TalkStyle\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCIS_v1-BdrTwGF2BQrGgPoiDd2u1A6XZw\",\n  authDomain: \"virtual-primer-354906.firebaseapp.com\",\n  databaseURL: \"https://virtual-primer-354906-default-rtdb.asia-southeast1.firebasedatabase.app\",\n  projectId: \"virtual-primer-354906\",\n  storageBucket: \"virtual-primer-354906.appspot.com\",\n  messagingSenderId: \"442922054622\",\n  appId: \"1:442922054622:web:aaa9cf4f99a2a45ef8a34f\",\n  measurementId: \"G-DM03L94YWH\"\n};\nconst firebaseApp = initializeApp(firebaseConfig);\nconst database = getDatabase();\nconst TomatoTalk = props => {\n  _s();\n  const formRef = useRef(); //html 노드 접근시 사용함 -\n  const msgRef = useRef();\n  const userIdRef = useRef();\n  // 클라우드 리얼데이터베이스 서버 정보 동기화 처리\n  // 메시지 전송시 객체로 넘겼으므로 초기화도 []가 아니라 {}로 해야 함 - 주의\n  const [messages, setMessages] = useState({});\n  // 사용자가 입력한 메시지 담기\n  const [message, setMessage] = useState({\n    m_no: 0,\n    userId: \"\",\n    msg: \"\",\n    curtime: \"\"\n  });\n  const setClock = () => {\n    const dateInfo = new Date();\n    const hour = modifyNumber(dateInfo.getHours());\n    const min = modifyNumber(dateInfo.getMinutes());\n    const sec = modifyNumber(dateInfo.getSeconds());\n    const curtime = hour + \":\" + min + \":\" + sec;\n    return curtime;\n  };\n  const modifyNumber = time => {\n    if (parseInt(time) < 10) return \"0\" + time;else return time;\n  };\n  useEffect(() => {\n    console.log(database);\n    setMessage({\n      ...message,\n      curtime: setClock()\n    });\n    const starCountRef = ref(database, \"talk\");\n    onValue(starCountRef, snapshot => {\n      const data = snapshot.val();\n      setMessages(data);\n    });\n  }, []);\n  const send = event => {\n    if (event.key === \"Enter\") {\n      //submit속성 사용시 반드시 아래코드 추가할것.- 버블링 방지- 주의할것\n      event.preventDefault();\n      //사용자가 입력해서 제출하고 나면 폼 리셋되도록해줌\n      formRef.current.reset();\n      set(ref(database, \"talk/\" + message.m_no), message);\n    }\n  };\n  const handleSend = event => {\n    //submit속성 사용시 반드시 아래코드 추가할것.- 버블링 방지- 주의할것\n    event.preventDefault();\n    //사용자가 입력해서 제출하고 나면 폼 리셋되도록해줌\n    formRef.current.reset();\n    set(ref(database, \"talk/\" + message.m_no), message);\n  };\n  const handleChangeForm = event => {\n    if (event.currentTarget == null) return;\n    console.log(\"폼 내용 변경 발생 name : \" + event.target.name);\n    console.log(\"폼 내용 변경 발생 value : \" + event.target.value);\n    setMessage({\n      ...message,\n      userId: \"토마토\",\n      m_no: Date.now(),\n      [event.target.name]: event.target.value\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"TomatoTalk\", /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa-solid fa-angles-right\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 23\n          }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n            children: \"\\uD1A0\\uB9C8\\uD1A0\\uB2D8 \\uC608\\uC57D\\uC0C1\\uB2F4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: messages && Object.keys(messages).map(key => /*#__PURE__*/_jsxDEV(MessageLi, {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn btn-primary\",\n              children: messages[key].msg\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 19\n            }, this), \"\\xA0(\", messages[key].curtime, \")\"]\n          }, key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        ref: formRef,\n        children: /*#__PURE__*/_jsxDEV(InputGroup, {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"hidden\",\n            ref: userIdRef,\n            name: \"userId\",\n            onChange: handleChangeForm\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            ref: msgRef,\n            name: \"msg\",\n            placeholder: \"\\uC5EC\\uAE30\\uC5D0 \\uB9D0\\uC500\\uD558\\uC138\\uC694.\",\n            \"aria-label\": \"Username\",\n            \"aria-describedby\": \"basic-addon1\",\n            onKeyDown: send,\n            onChange: handleChangeForm\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"warning\",\n            onClick: handleSend,\n            children: \"send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n_s(TomatoTalk, \"c3V1FuNzHcvxz+6BCLa1UjkS7Dw=\");\n_c = TomatoTalk;\nexport default TomatoTalk;\nvar _c;\n$RefreshReg$(_c, \"TomatoTalk\");","map":{"version":3,"names":["React","useEffect","useRef","useState","getDatabase","ref","onValue","set","initializeApp","Button","Form","InputGroup","MessageLi","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firebaseApp","database","TomatoTalk","props","formRef","msgRef","userIdRef","messages","setMessages","message","setMessage","m_no","userId","msg","curtime","setClock","dateInfo","Date","hour","modifyNumber","getHours","min","getMinutes","sec","getSeconds","time","parseInt","console","log","starCountRef","snapshot","data","val","send","event","key","preventDefault","current","reset","handleSend","handleChangeForm","currentTarget","target","name","value","now","Object","keys","map"],"sources":["C:/git_java20220415/Redux-Basic/src/components/talk/TomatoTalk.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport { getDatabase, ref, onValue, set } from \"firebase/database\";\r\nimport { initializeApp } from \"firebase/app\";\r\nimport { Button, Form, InputGroup } from \"react-bootstrap\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport { MessageLi } from \"../style/TalkStyle\";\r\n\r\n const firebaseConfig = {\r\n  apiKey: \"AIzaSyCIS_v1-BdrTwGF2BQrGgPoiDd2u1A6XZw\",\r\n  authDomain: \"virtual-primer-354906.firebaseapp.com\",\r\n  databaseURL:\r\n    \"https://virtual-primer-354906-default-rtdb.asia-southeast1.firebasedatabase.app\",\r\n  projectId: \"virtual-primer-354906\",\r\n  storageBucket: \"virtual-primer-354906.appspot.com\",\r\n  messagingSenderId: \"442922054622\",\r\n  appId: \"1:442922054622:web:aaa9cf4f99a2a45ef8a34f\",\r\n  measurementId: \"G-DM03L94YWH\",\r\n};\r\n\r\nconst firebaseApp = initializeApp(firebaseConfig);\r\nconst database = getDatabase();\r\n\r\nconst TomatoTalk = (props) => {\r\n  const formRef = useRef(); //html 노드 접근시 사용함 -\r\n  const msgRef = useRef();\r\n  const userIdRef = useRef();\r\n  // 클라우드 리얼데이터베이스 서버 정보 동기화 처리\r\n  // 메시지 전송시 객체로 넘겼으므로 초기화도 []가 아니라 {}로 해야 함 - 주의\r\n  const [messages, setMessages] = useState({});\r\n  // 사용자가 입력한 메시지 담기\r\n  const [message, setMessage] = useState({\r\n    m_no: 0,\r\n    userId: \"\",\r\n    msg: \"\",\r\n    curtime: \"\",\r\n  });\r\n  const setClock = () => {\r\n    const dateInfo = new Date();\r\n    const hour = modifyNumber(dateInfo.getHours());\r\n    const min = modifyNumber(dateInfo.getMinutes());\r\n    const sec = modifyNumber(dateInfo.getSeconds());\r\n    const curtime = hour + \":\" + min + \":\" + sec;\r\n    return curtime;\r\n  };\r\n  const modifyNumber = (time) => {\r\n    if (parseInt(time) < 10) return \"0\" + time;\r\n    else return time;\r\n  };\r\n  useEffect(() => {\r\n    console.log(database);\r\n    setMessage({ ...message, curtime: setClock() });\r\n    const starCountRef = ref(database, \"talk\");\r\n    onValue(starCountRef, (snapshot) => {\r\n      const data = snapshot.val();\r\n      setMessages(data);\r\n    });\r\n  }, []);\r\n  const send = (event) => {\r\n    if (event.key === \"Enter\") {\r\n      //submit속성 사용시 반드시 아래코드 추가할것.- 버블링 방지- 주의할것\r\n      event.preventDefault();\r\n      //사용자가 입력해서 제출하고 나면 폼 리셋되도록해줌\r\n      formRef.current.reset();\r\n      set(ref(database, \"talk/\" + message.m_no), message);\r\n    }\r\n  };\r\n  const handleSend = (event) => {\r\n    //submit속성 사용시 반드시 아래코드 추가할것.- 버블링 방지- 주의할것\r\n    event.preventDefault();\r\n    //사용자가 입력해서 제출하고 나면 폼 리셋되도록해줌\r\n    formRef.current.reset();\r\n    set(ref(database, \"talk/\" + message.m_no), message);\r\n  };\r\n  const handleChangeForm = (event) => {\r\n    if (event.currentTarget == null) return;\r\n    console.log(\"폼 내용 변경 발생 name : \" + event.target.name);\r\n    console.log(\"폼 내용 변경 발생 value : \" + event.target.value);\r\n\r\n    setMessage({\r\n      ...message,\r\n      userId: \"토마토\",\r\n      m_no: Date.now(),\r\n      [event.target.name]: event.target.value,\r\n    });\r\n  };\r\n  return (\r\n    <>\r\n      <div className=\"container\">\r\n        <div className=\"page-header\">\r\n          <h2>\r\n            TomatoTalk<i className=\"fa-solid fa-angles-right\"></i>\r\n            <small>토마토님 예약상담</small>\r\n          </h2>\r\n          <hr />\r\n        </div>\r\n        <div>\r\n          <ul>\r\n            {messages &&\r\n              Object.keys(messages).map((key) => (\r\n                <MessageLi key={key}>\r\n                  <Button className=\"btn btn-primary\">\r\n                    {messages[key].msg}\r\n                  </Button>\r\n                  &nbsp;({messages[key].curtime})\r\n                </MessageLi>\r\n              ))}\r\n          </ul>\r\n        </div>\r\n        <Form ref={formRef}>\r\n          <InputGroup className=\"mb-3\">\r\n            <input\r\n              type=\"hidden\"\r\n              ref={userIdRef}\r\n              name=\"userId\"\r\n              onChange={handleChangeForm}\r\n            />\r\n            <Form.Control\r\n              ref={msgRef}\r\n              name=\"msg\"\r\n              placeholder=\"여기에 말씀하세요.\"\r\n              aria-label=\"Username\"\r\n              aria-describedby=\"basic-addon1\"\r\n              onKeyDown={send}\r\n              onChange={handleChangeForm}\r\n            />\r\n            <Button variant=\"warning\" onClick={handleSend}>\r\n              send\r\n            </Button>\r\n          </InputGroup>\r\n        </Form>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default TomatoTalk;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}